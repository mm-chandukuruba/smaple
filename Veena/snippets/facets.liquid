{% comment %}
  Renders facets (filtering and sorting)

  Accepts:
  - results: {Object} Collection or Search object
  - enable_filtering: {Boolean} Show filtering when true
  - enable_sorting: {Boolean} Show sorting when true
  - filter_type: {String} Type of filter
  - paginate: {Object}

  Usage:
  {% render 'facets', results: collection, enable_filtering: true, enable_sorting: true, filter_type: 'vertical', paginate: paginate %}
{% endcomment %}

{{ 'component-show-more.css' | asset_url | stylesheet_tag }}
{{ 'component-visual-display.css' | asset_url | stylesheet_tag }}

{%- liquid
  assign sort_by = results.sort_by | default: results.default_sort_by
  assign total_active_values = 0
  if results.url
    assign results_url = results.url
  else
    assign terms = results.terms | escape
    assign results_url = '?q=' | append: terms | append: '&options%5Bprefix%5D=last&sort_by=' | append: sort_by
  endif
-%}

<div class="facets-container{% if filter_type == 'drawer' %} facets-container-drawer{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}">
  <ul class="facets-menu__link-container small-hide {% unless filter_type == 'vertical' %} medium-hide large-up-hide{% endunless %}">
    {% for childLink in section.settings.menu.links %}
      {% if childLink.links != blank %}
        <li>
        <details class="facets__disclosure-vertical">
          <summary
              class="facets__summary caption-large focus-offset facets-menu__link-summary"
            >
              <div>
                <span class="facets__summary-label">
                  {{- childLink.title | escape }}
                </span>
                {% render 'icon-caret' %}
              </div>
            </summary>
          <ul>
            {% for grandChild in childLink.links %}
              <li class="caption-large link link-text focus-inset facets-menu__link-summary">{{ grandChild.title | link_to: grandChild.url }}</li>
            {% endfor %}
          </ul>
        </details>
        </li>
        {% else %}
        <li class="facets-menu__link-summary facets__summary">{{ childLink.title | link_to: childLink.url }}</li>
      {% endif %}
    {% endfor %}
  </ul>
  {%- if filter_type == 'vertical' or filter_type == 'horizontal' -%}
    <facet-filters-form class="facets small-hide">
      <form
        id="FacetFiltersForm"
        class="{% if filter_type == 'horizontal' %}facets__form{% else %}facets__form-vertical{% endif %}"
      >
        {%- if results.terms -%}
          <input type="hidden" name="q" value="{{ results.terms | escape }}">
          <input name="options[prefix]" type="hidden" value="last">
        {%- endif -%}

        {% if enable_filtering %}
          {% comment %} Heading is the first tabbable element on filter type horizontal {% endcomment %}
          <div
            id="FacetsWrapperDesktop"
            {% if filter_type == 'horizontal' %}
              class="facets__wrapper"
            {% endif %}
          >
            {%- if filter_type == 'horizontal' and results.filters != empty -%}
              <h2 class="facets__heading caption-large text-body" id="verticalTitle" tabindex="-1">
                {{ 'products.facets.filter_by_label' | t }}
              </h2>
            {%- endif -%}
            {% comment %} Pills are right below the title for filter type vertical {% endcomment %}
            {%- if filter_type == 'vertical' -%}
              <div class="active-facets active-facets-desktop">
                <div class="active-facets-vertical-filter">
                  {%- unless results.filters == empty -%}
                    <h2
                      class="facets__heading facets__heading--vertical caption-large text-body"
                      id="verticalTitle"
                      tabindex="-1"
                    >
                      {{ 'products.facets.filter_by_label' | t }}
                    </h2>
                  {%- endunless -%}
                  <facet-remove class="active-facets__button-wrapper">
                    <a href="{{ results_url }}" class="active-facets__button-remove underlined-link">
                      <span>{{ 'products.facets.clear_all' | t }}</span>
                    </a>
                  </facet-remove>
                </div>
                {%- for filter in results.filters -%}
                  {%- for value in filter.active_values -%}
                    <facet-remove>
                      <a href="{{ value.url_to_remove }}" class="active-facets__button active-facets__button--light">
                        <span class="active-facets__button-inner button button--tertiary">
                          {{ filter.label }}: {{ value.label | escape }}
                          {% render 'icon-close-small' %}
                          <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                        </span>
                      </a>
                    </facet-remove>
                  {%- endfor -%}
                  {% if filter.type == 'price_range' %}
                    {%- if filter.min_value.value != null or filter.max_value.value != null -%}
                      <facet-remove>
                        <a href="{{ filter.url_to_remove }}" class="active-facets__button active-facets__button--light">
                          <span class="active-facets__button-inner button button--tertiary">
                            {%- if filter.min_value.value -%}
                              {{ filter.min_value.value | money }}
                            {%- else -%}
                              {{ 0 | money }}
                            {%- endif -%}
                            -
                            {%- if filter.max_value.value -%}
                              {{ filter.max_value.value | money }}
                            {%- else -%}
                              {{ filter.range_max | money }}
                            {%- endif -%}
                            {% render 'icon-close-small' %}
                            <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                          </span>
                        </a>
                      </facet-remove>
                    {%- endif -%}
                  {% endif %}
                {%- endfor -%}
              </div>
            {%- endif -%}

            <script src="{{ 'show-more.js' | asset_url }}" defer="defer"></script>
            {% comment %} Filters for both horizontal and vertical filter {% endcomment %}
            {%- for filter in results.filters -%}
              {% liquid
                assign total_active_values = total_active_values | plus: filter.active_values.size
                case filter.presentation
                  when 'swatch'
                    assign has_visual_display = true
                    assign show_more_number = 15
                    assign visual_layout_class = 'facets-layout-grid facets-layout-grid--' | append: filter.presentation
                  else
                    assign has_visual_display = false
                    assign visual_layout_class = 'facets-layout-list'
                    assign show_more_number = 10
                endcase
              %}

              {% case filter.type %}
                {% when 'boolean', 'list' %}
                  <details
                    id="Details-{{ forloop.index }}-{{ section.id }}"
                    class="{% if filter_type == 'horizontal' %}disclosure-has-popup facets__disclosure{% else %} facets__disclosure-vertical{% endif %} js-filter"
                    data-index="{{ forloop.index }}"
                    {% if filter_type == 'vertical' and forloop.index == 1 %}
                      open
                    {% endif %}
                  >
                    <summary
                      class="facets__summary caption-large focus-offset"
                      aria-label="{{ filter.label }} ({{ 'products.facets.filters_selected.one' | t: count: filter.active_values.size }})"
                    >
                      <div>
                        <span class="facets__summary-label">
                          {{- filter.label | escape }}
                          {%- if filter_type == 'vertical' -%}
                            <span class="facets__selected no-js-hidden{% if filter.active_values.size == 0 %} hidden{% endif %}">
                              ({{ filter.active_values.size }})</span
                            >
                          {%- endif -%}
                        </span>
                        {%- if filter_type == 'vertical' and filter.operator == 'AND' -%}
                          <span class="facets__and-helptext">
                            {{ 'products.facets.filter_and_operator_subtitle' | t }}
                          </span>
                        {%- endif -%}
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div
                      id="Facet-{{ forloop.index }}-{{ section.id }}"
                      class="parent-display {% if filter_type == 'horizontal' %}facets__display{% else %}facets__display-vertical{% endif %}"
                    >
                      {%- if filter_type != 'vertical' -%}
                        <div class="facets__header">
                          <div>
                            <span class="facets__selected no-js-hidden">
                              {{- 'products.facets.filters_selected' | t: count: filter.active_values.size -}}
                            </span>
                            {%- if filter.operator == 'AND' -%}
                              <span class="facets__and-helptext">
                                {{ 'products.facets.filter_and_operator_subtitle' | t }}
                              </span>
                            {%- endif -%}
                          </div>
                          <facet-remove>
                            <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link">
                              {{ 'products.facets.reset' | t }}
                            </a>
                          </facet-remove>
                        </div>
                      {%- endif -%}
                      <fieldset class="facets-wrap parent-wrap {% if filter_type == 'vertical' %} facets-wrap-vertical{% endif %}">
                        <legend class="visually-hidden">{{ filter.label | escape }}</legend>
                        <ul
                          class="{{ visual_layout_class }}{% if filter_type == 'vertical' %} facets__list--vertical{% else %} facets__list{% endif %} list-unstyled no-js-hidden"
                          role="list"
                        >
                          {%- liquid
                            assign sorted_values = filter.values
                            # Keep the selected values grouped together when operator is AND
                            if filter.operator == 'AND'
                              assign active_filter_values = filter.values | where: 'active', true
                              assign inactive_filter_values = filter.values | where: 'active', false
                              assign sorted_values = active_filter_values | concat: inactive_filter_values
                            endif
                          -%}
                          {%- for value in sorted_values -%}
                            {% liquid
                              assign is_disabled = false
                              if value.count == 0 and value.active == false
                                assign is_disabled = true
                              endif
                            %}

                            <li class="list-menu__item facets__item {% if forloop.index > show_more_number and filter_type == 'vertical' %} show-more-item hidden{% endif %}">
                              <label
                                for="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}"
                                class="facets__label facet-checkbox item-swatch {% if is_disabled %} facet-checkbox--disabled disabled{% endif %}{% if has_visual_display %} visual-display-parent visual-display-parent--{{ filter.presentation }}{% endif %}{% if value.active %} active{% endif %}"
                                
                              >
                                <input
                                  type="checkbox"
                                  name="{{ value.param_name }}"
                                  value="{{ value.value }}"
                                  id="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}"
                                  {% if value.active %}
                                    checked
                                  {% endif %}
                                  {% if is_disabled %}
                                    disabled
                                  {% endif %}
                                >

                                {% if has_visual_display %}
                                  <div class="facets__visual-display-wrapper">
                                    {% render 'visual-display',
                                      type: value.display.type,
                                      value: value.display.value,
                                      presentation: filter.presentation
                                    %}
                                  </div>
                                {% else %}
                                  <svg
                                    width="1.6rem"
                                    height="1.6rem"
                                    viewBox="0 0 16 16"
                                    aria-hidden="true"
                                    focusable="false"
                                    data-value="{{value.value}}"
                                  >
                                    <rect width="16" height="16"  fill="none" ></rect>
                                  </svg>                               
                                {% endif %}

                                <span class="facet-checkbox__text" aria-hidden="true">
                                  {{- value.label | escape }} ({{ value.count }})</span
                                >
                                <span class="visually-hidden">
                                  {{- value.label | escape }} (
                                  {%- if value.count == 1 -%}
                                    {{- 'products.facets.product_count_simple.one' | t: count: value.count -}}
                                  {%- else -%}
                                    {{- 'products.facets.product_count_simple.other' | t: count: value.count -}}
                                  {%- endif -%}
                                  )</span
                                >
                              </label>
                            </li>
                          {%- endfor -%}
                        </ul>
                        {% comment %} No show more for no JS {% endcomment %}
                        <ul
                          class="{% if filter_type != 'vertical' %} facets__list{% endif %} no-js-list list-unstyled no-js"
                          role="list"
                        >
                          {%- for value in filter.values -%}
                            <li class="list-menu__item facets__item">
                              <label
                                for="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}-no-js"
                                class="facet-checkbox item-swatch {% if value.count == 0 and value.active == false %} facet-checkbox--disabled{% endif %}"
                              >
                                <input
                                  type="checkbox"
                                  name="{{ value.param_name }}"
                                  value="{{ value.value }}"
                                  id="Filter-{{ filter.param_name | escape }}-{{ forloop.index }}-no-js"
                                  {% if value.active %}
                                    checked
                                  {% endif %}
                                  {% if value.count == 0 and value.active == false %}
                                    disabled
                                  {% endif %}
                                >

                                <svg
                                  width="1.6rem"
                                  height="1.6rem"
                                  viewBox="0 0 16 16"
                                  aria-hidden="true"
                                  focusable="false"
                                  data-value="{{ value.value }}"
                                >
                                  <rect width="16" height="16" fill="none" ></rect>
                                </svg>

                                <span aria-hidden="true">{{ value.label | escape }} ({{ value.count }})</span>
                                <span class="visually-hidden">
                                  {{- value.label | escape }} (
                                  {%- if value.count == 1 -%}
                                    {{- 'products.facets.product_count_simple.one' | t: count: value.count -}}
                                  {%- else -%}
                                    {{- 'products.facets.product_count_simple.other' | t: count: value.count -}}
                                  {%- endif -%}
                                  )</span
                                >
                              </label>
                            </li>
                          {%- endfor -%}
                        </ul>
                      </fieldset>
                      {%- if filter.values.size > show_more_number and filter_type == 'vertical' -%}
                        <show-more-button>
                          <button
                            class="button-show-more link underlined-link no-js-hidden"
                            id="Show-More-{{ forloop.index }}-{{ section.id }}"
                            type="button"
                          >
                            <span class="label-show-more label-text"
                              ><span aria-hidden="true">+ </span>{{ 'products.facets.show_more' | t -}}
                            </span>
                            <span class="label-show-less label-text hidden"
                              ><span aria-hidden="true">- </span>{{ 'products.facets.show_less' | t -}}
                            </span>
                          </button>
                        </show-more-button>
                      {%- endif %}
                    </div>
                  </details>
                {% when 'price_range' %}
                  {% liquid
                    assign currencies_using_comma_decimals = 'ANG,ARS,BRL,BYN,BYR,CLF,CLP,COP,CRC,CZK,DKK,EUR,HRK,HUF,IDR,ISK,MZN,NOK,PLN,RON,RUB,SEK,UYU,VES,VND' | split: ','
                    assign uses_comma_decimals = false
                    if currencies_using_comma_decimals contains cart.currency.iso_code
                      assign uses_comma_decimals = true
                    endif
                  %}
                  <details
                    id="Details-{{ forloop.index }}-{{ section.id }}"
                    class="{% if filter_type == 'horizontal' %}disclosure-has-popup facets__disclosure{% else %} facets__disclosure-vertical{% endif %} js-filter"
                    data-index="{{ forloop.index }}"
                    {% if filter_type == 'vertical' and forloop.index == 1 %}
                      open
                    {% endif %}
                  >
                    <summary class="facets__summary caption-large focus-offset">
                      <div>
                        <span>{{ filter.label | escape }}</span>
                        {% render 'icon-caret' %}
                      </div>
                    </summary>
                    <div
                      id="Facet-{{ forloop.index }}-{{ section.id }}"
                      class="{% if filter_type == 'horizontal' %}facets__display{% else %}facets__display-vertical{% endif %}"
                    >
                      <div class="{% if filter_type == 'horizontal' %}facets__header{% else %}facets__header-vertical{% endif %}">
                        {%- assign max_price_amount = filter.range_max | money | strip_html | escape -%}
                        <span class="facets__selected">
                          {{- 'products.facets.max_price' | t: price: max_price_amount -}}
                        </span>
                        {%- if filter_type != 'vertical' -%}
                          <facet-remove>
                            <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link">
                              {{ 'products.facets.reset' | t }}
                            </a>
                          </facet-remove>
                        {%- endif -%}
                      </div>
                      <price-range class="facets__price">
                        <span class="field-currency">{{ cart.currency.symbol }}</span>
                        <div class="field">
                          <input
                            class="field__input"
                            name="{{ filter.min_value.param_name }}"
                            id="Filter-{{ filter.label | escape }}-GTE"
                            {%- if filter.min_value.value -%}
                              {%- if uses_comma_decimals -%}
                                value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                              {%- else -%}
                                value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                              {%- endif %}
                            {%- endif -%}
                            type="number"
                            placeholder="0"
                            min="0"
                            {%- if uses_comma_decimals -%}
                              max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                            {%- else -%}
                              max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                            {% endif %}
                          >
                          <label class="field__label" for="Filter-{{ filter.label | escape }}-GTE">
                            {{- 'products.facets.from' | t -}}
                          </label>
                        </div>
                        {%- if filter_type != 'vertical' -%}
                          <span class="field-currency">{{ cart.currency.symbol }}</span>
                        {%- endif -%}
                        <div class="field">
                          <input
                            class="field__input"
                            name="{{ filter.max_value.param_name }}"
                            id="Filter-{{ filter.label | escape }}-LTE"
                            {%- if filter.max_value.value -%}
                              {%- if uses_comma_decimals -%}
                                value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                              {%- else -%}
                                value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                              {%- endif %}
                            {%- endif -%}
                            type="number"
                            min="0"
                            {%- if uses_comma_decimals -%}
                              placeholder="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                              max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                            {%- else -%}
                              placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                              max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                            {% endif %}
                          >
                          <label class="field__label" for="Filter-{{ filter.label | escape }}-LTE">
                            {{- 'products.facets.to' | t -}}
                          </label>
                        </div>
                      </price-range>
                    </div>
                  </details>
              {% endcase %}
            {%- endfor -%}
            <noscript>
              <button type="submit" class="facets__button-no-js button button--secondary">
                {{ 'products.facets.filter_button' | t }}
              </button>
            </noscript>
          </div>
          {% comment %} Pills after filtes on filter type horizontal {% endcomment %}
          {%- if filter_type == 'horizontal' -%}
            <div class="active-facets active-facets-desktop">
              {%- for filter in results.filters -%}
                {%- for value in filter.active_values -%}
                  <facet-remove>
                    <a href="{{ value.url_to_remove }}" class="active-facets__button active-facets__button--light">
                      <span class="active-facets__button-inner button button--tertiary">
                        {{ filter.label }}: {{ value.label | escape }}
                        {% render 'icon-close-small' %}
                        <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                      </span>
                    </a>
                  </facet-remove>
                {%- endfor -%}
                {% if filter.type == 'price_range' %}
                  {%- if filter.min_value.value != null or filter.max_value.value != null -%}
                    <facet-remove>
                      <a href="{{ filter.url_to_remove }}" class="active-facets__button active-facets__button--light">
                        <span class="active-facets__button-inner button button--tertiary">
                          {%- if filter.min_value.value -%}
                            {{ filter.min_value.value | money }}
                          {%- else -%}
                            {{ 0 | money }}
                          {%- endif -%}
                          -
                          {%- if filter.max_value.value -%}
                            {{ filter.max_value.value | money }}
                          {%- else -%}
                            {{ filter.range_max | money }}
                          {%- endif -%}
                          {% render 'icon-close-small' %}
                          <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                        </span>
                      </a>
                    </facet-remove>
                  {%- endif -%}
                {% endif %}
              {%- endfor -%}
              <facet-remove class="active-facets__button-wrapper">
                <a href="{{ results_url }}" class="active-facets__button-remove underlined-link">
                  <span>{{ 'products.facets.clear_all' | t }}</span>
                </a>
              </facet-remove>
            </div>
          {%- endif -%}
        {% endif %}

        {% if results.current_vendor or results.current_type %}
          <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
        {% endif %}

        {%- if filter_type == 'horizontal' -%}
          {% comment %} Sorting and product count are the last elements when filter type is horizontal {% endcomment %}
          {%- if enable_sorting -%}
            <div class="facet-filters sorting caption">
              <div class="facet-filters__field">
                <h2 class="facet-filters__label caption-large text-body">
                  <label for="SortBy">{{ 'products.facets.sort_by_label' | t }}</label>
                </h2>
                <div class="select">
                  {%- assign sort_by = results.sort_by | default: results.default_sort_by -%}
                  <select
                    name="sort_by"
                    class="facet-filters__sort select__select caption-large"
                    id="SortBy"
                    aria-describedby="a11y-refresh-page-message"
                  >
                    {%- for option in results.sort_options -%}
                      <option
                        value="{{ option.value | escape }}"
                        {% if option.value == sort_by %}
                          selected="selected"
                        {% endif %}
                      >
                        {{ option.name | escape }}
                      </option>
                    {%- endfor -%}
                  </select>
                  {% render 'icon-caret' %}
                </div>
              </div>

              <noscript>
                <button type="submit" class="facets__button-no-js button button--secondary">
                  {{ 'products.facets.sort_button' | t }}
                </button>
              </noscript>
            </div>
          {%- endif -%}
          <div class="product-count light" role="status">
            <h2 class="product-count__text text-body">
              <span id="ProductCountDesktop">
                {%- if results.results_count -%}
                  {{ 'templates.search.results_with_count' | t: terms: results.terms, count: results.results_count }}
                {%- elsif results.products_count == results.all_products_count -%}
                  {{ 'products.facets.product_count_simple' | t: count: results.products_count }}
                {%- else -%}
                  {{
                    'products.facets.product_count'
                    | t: product_count: results.products_count, count: results.all_products_count
                  }}
                {%- endif -%}
              </span>
            </h2>
            {%- render 'loading-spinner' -%}
          </div>
        {%- endif -%}
      </form>
    </facet-filters-form>
    {% comment %} Sorting for vertical filter are grouped with filter when no JS{% endcomment %}
    {%- if enable_sorting and filter_type == 'vertical' -%}
      <facet-filters-form class="small-hide">
        <form class="no-js">
          <div class="facet-filters sorting caption">
            <div class="facet-filters__field">
              <h2 class="facet-filters__label caption-large text-body">
                <label for="SortBy">{{ 'products.facets.sort_by_label' | t }}</label>
              </h2>
              <div class="select">
                {%- assign sort_by = results.sort_by | default: results.default_sort_by -%}
                <select
                  name="sort_by"
                  class="facet-filters__sort select__select caption-large"
                  id="SortBy"
                  aria-describedby="a11y-refresh-page-message"
                >
                  {%- for option in results.sort_options -%}
                    <option
                      value="{{ option.value | escape }}"
                      {% if option.value == sort_by %}
                        selected="selected"
                      {% endif %}
                    >
                      {{ option.name | escape }}
                    </option>
                  {%- endfor -%}
                </select>
                {% render 'icon-caret' %}
              </div>
            </div>

            <noscript>
              <button type="submit" class="facets__button-no-js button button--secondary">
                {{ 'products.facets.sort_button' | t }}
              </button>
            </noscript>
          </div>

          {% if results.current_vendor or results.current_type %}
            <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
          {% endif %}

          {%- if results.terms -%}
            <input type="hidden" name="q" value="{{ results.terms | escape }}">
            <input name="options[prefix]" type="hidden" value="last">
          {%- endif -%}
        </form>
      </facet-filters-form>
    {%- endif -%}
  {%- endif -%}
  {% comment %}  Drawer and mobile filter {% endcomment %}
  <menu-drawer
    class="mobile-facets__wrapper{% if filter_type == 'horizontal' or filter_type == 'vertical' %} medium-hide large-up-hide{% endif %}"
    data-breakpoint="mobile"
  >
    <div>
      <button type="button" class="change-button-mobile" data-index="2">
        <svg width="27" height="19" viewBox="0 0 27 19" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M0.500003 15.7488C0.500005 15.734 0.500007 15.7191 0.500007 15.7041L0.500003 3.25083C0.499952 2.81802 0.499905 2.42119 0.543306 2.09838C0.591099 1.7429 0.703546 1.36717 1.01257 1.05815C1.32159 0.749121 1.69732 0.636675 2.0528 0.58888C2.37561 0.545481 2.77244 0.545526 3.20526 0.545578L4.79475 0.545578C5.22757 0.545526 5.6244 0.545481 5.94721 0.58888C6.30269 0.636675 6.67842 0.74912 6.98744 1.05815C7.29647 1.36717 7.40891 1.74289 7.45671 2.09838C7.50011 2.42119 7.50006 2.81802 7.50001 3.25084L7.50001 15.7041C7.50001 15.7191 7.50001 15.734 7.50001 15.7488C7.50006 16.1817 7.50011 16.5785 7.45671 16.9013C7.40891 17.2568 7.29647 17.6325 6.98744 17.9415C6.67842 18.2506 6.30269 18.363 5.94721 18.4108C5.6244 18.4542 5.22757 18.4541 4.79476 18.4541C4.77988 18.4541 4.76496 18.4541 4.75001 18.4541L3.25001 18.4541C3.23505 18.4541 3.22013 18.4541 3.20526 18.4541C2.77244 18.4541 2.37561 18.4542 2.0528 18.4108C1.69732 18.363 1.32159 18.2506 1.01257 17.9415C0.703547 17.6325 0.5911 17.2568 0.543306 16.9013C0.499906 16.5785 0.499952 16.1817 0.500003 15.7488ZM2.07324 16.8809L2.07187 16.8784C2.07086 16.8765 2.06924 16.8732 2.06717 16.8681C2.0582 16.8464 2.04291 16.798 2.02993 16.7014C2.0016 16.4907 2.00001 16.1967 2.00001 15.7041L2.00001 3.29558C2.00001 2.80298 2.0016 2.50897 2.02993 2.29825C2.04291 2.20169 2.0582 2.15333 2.06716 2.13155C2.06924 2.1265 2.07086 2.12319 2.07187 2.12125L2.07324 2.11882L2.07568 2.11744C2.07761 2.11643 2.08093 2.11482 2.08597 2.11274C2.10775 2.10378 2.15611 2.08849 2.25267 2.07551C2.46339 2.04718 2.7574 2.04558 3.25001 2.04558L4.75001 2.04558C5.24261 2.04558 5.53662 2.04718 5.74734 2.07551C5.8439 2.08849 5.89226 2.10378 5.91404 2.11274C5.91909 2.11482 5.9224 2.11643 5.92434 2.11744L5.92677 2.11882L5.92815 2.12125C5.92916 2.12319 5.93077 2.1265 5.93285 2.13155C5.94181 2.15333 5.9571 2.20169 5.97008 2.29825C5.99841 2.50897 6.00001 2.80298 6.00001 3.29558L6.00001 15.7041C6.00001 16.1967 5.99841 16.4907 5.97008 16.7014C5.9571 16.798 5.94181 16.8463 5.93285 16.8681C5.93077 16.8732 5.92916 16.8765 5.92815 16.8784L5.92677 16.8809L5.92434 16.8822C5.9224 16.8832 5.91909 16.8849 5.91404 16.8869C5.89226 16.8959 5.8439 16.9112 5.74734 16.9242C5.53662 16.9525 5.24261 16.9541 4.75001 16.9541L3.25001 16.9541C2.7574 16.9541 2.46339 16.9525 2.25267 16.9242C2.15611 16.9112 2.10775 16.8959 2.08597 16.8869C2.08093 16.8849 2.07761 16.8832 2.07568 16.8822L2.07324 16.8809ZM5.92677 16.8809C5.92644 16.8811 5.92636 16.8813 5.92677 16.8809C5.92723 16.8804 5.92705 16.8805 5.92677 16.8809ZM5.92677 2.11882C5.92679 2.11883 5.92679 2.11883 5.92677 2.11882Z"></path>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M10 15.7488C10 15.734 10 15.7191 10 15.7041L10 3.25083C9.99995 2.81802 9.9999 2.42119 10.0433 2.09838C10.0911 1.7429 10.2035 1.36717 10.5126 1.05815C10.8216 0.749121 11.1973 0.636675 11.5528 0.58888C11.8756 0.545481 12.2724 0.545526 12.7053 0.545578L14.2948 0.545578C14.7276 0.545526 15.1244 0.545481 15.4472 0.58888C15.8027 0.636675 16.1784 0.74912 16.4874 1.05815C16.7965 1.36717 16.9089 1.74289 16.9567 2.09838C17.0001 2.42119 17.0001 2.81802 17 3.25084L17 15.7041C17 15.7191 17 15.734 17 15.7488C17.0001 16.1817 17.0001 16.5785 16.9567 16.9013C16.9089 17.2568 16.7965 17.6325 16.4874 17.9415C16.1784 18.2506 15.8027 18.363 15.4472 18.4108C15.1244 18.4542 14.7276 18.4541 14.2948 18.4541C14.2799 18.4541 14.265 18.4541 14.25 18.4541L12.75 18.4541C12.735 18.4541 12.7201 18.4541 12.7053 18.4541C12.2724 18.4541 11.8756 18.4542 11.5528 18.4108C11.1973 18.363 10.8216 18.2506 10.5126 17.9415C10.2035 17.6325 10.0911 17.2568 10.0433 16.9013C9.99991 16.5785 9.99995 16.1817 10 15.7488ZM11.5732 16.8809L11.5719 16.8784C11.5709 16.8765 11.5692 16.8732 11.5672 16.8681C11.5582 16.8464 11.5429 16.798 11.5299 16.7014C11.5016 16.4907 11.5 16.1967 11.5 15.7041L11.5 3.29558C11.5 2.80298 11.5016 2.50897 11.5299 2.29825C11.5429 2.20169 11.5582 2.15333 11.5672 2.13155C11.5692 2.1265 11.5709 2.12319 11.5719 2.12125L11.5732 2.11882L11.5757 2.11744C11.5776 2.11643 11.5809 2.11482 11.586 2.11274C11.6078 2.10378 11.6561 2.08849 11.7527 2.07551C11.9634 2.04718 12.2574 2.04558 12.75 2.04558L14.25 2.04558C14.7426 2.04558 15.0366 2.04718 15.2473 2.07551C15.3439 2.08849 15.3923 2.10378 15.414 2.11274C15.4191 2.11482 15.4224 2.11643 15.4243 2.11744L15.4268 2.11882L15.4281 2.12125C15.4292 2.12319 15.4308 2.1265 15.4328 2.13155C15.4418 2.15333 15.4571 2.20169 15.4701 2.29825C15.4984 2.50897 15.5 2.80298 15.5 3.29558L15.5 15.7041C15.5 16.1967 15.4984 16.4907 15.4701 16.7014C15.4571 16.798 15.4418 16.8463 15.4328 16.8681C15.4308 16.8732 15.4292 16.8765 15.4281 16.8784L15.4268 16.8809L15.4243 16.8822C15.4224 16.8832 15.4191 16.8849 15.414 16.8869C15.3923 16.8959 15.3439 16.9112 15.2473 16.9242C15.0366 16.9525 14.7426 16.9541 14.25 16.9541L12.75 16.9541C12.2574 16.9541 11.9634 16.9525 11.7527 16.9242C11.6561 16.9112 11.6078 16.8959 11.586 16.8869C11.5809 16.8849 11.5776 16.8832 11.5757 16.8822L11.5732 16.8809ZM15.4268 16.8809C15.4264 16.8811 15.4264 16.8813 15.4268 16.8809C15.4272 16.8804 15.4271 16.8805 15.4268 16.8809ZM15.4268 2.11882C15.4268 2.11883 15.4268 2.11883 15.4268 2.11882Z"></path>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 15.7488C19.5 15.734 19.5 15.7191 19.5 15.7041L19.5 3.25083C19.5 2.81802 19.4999 2.42119 19.5433 2.09838C19.5911 1.7429 19.7035 1.36717 20.0126 1.05815C20.3216 0.749121 20.6973 0.636675 21.0528 0.58888C21.3756 0.545481 21.7724 0.545526 22.2053 0.545578L23.7948 0.545578C24.2276 0.545526 24.6244 0.545481 24.9472 0.58888C25.3027 0.636675 25.6784 0.74912 25.9874 1.05815C26.2965 1.36717 26.4089 1.74289 26.4567 2.09838C26.5001 2.42119 26.5001 2.81802 26.5 3.25084L26.5 15.7041C26.5 15.7191 26.5 15.734 26.5 15.7488C26.5001 16.1817 26.5001 16.5785 26.4567 16.9013C26.4089 17.2568 26.2965 17.6325 25.9874 17.9415C25.6784 18.2506 25.3027 18.363 24.9472 18.4108C24.6244 18.4542 24.2276 18.4541 23.7948 18.4541C23.7799 18.4541 23.765 18.4541 23.75 18.4541L22.25 18.4541C22.235 18.4541 22.2201 18.4541 22.2053 18.4541C21.7724 18.4541 21.3756 18.4542 21.0528 18.4108C20.6973 18.363 20.3216 18.2506 20.0126 17.9415C19.7035 17.6325 19.5911 17.2568 19.5433 16.9013C19.4999 16.5785 19.5 16.1817 19.5 15.7488ZM21.0732 16.8809L21.0719 16.8784C21.0709 16.8765 21.0692 16.8732 21.0672 16.8681C21.0582 16.8464 21.0429 16.798 21.0299 16.7014C21.0016 16.4907 21 16.1967 21 15.7041L21 3.29558C21 2.80298 21.0016 2.50897 21.0299 2.29825C21.0429 2.20169 21.0582 2.15333 21.0672 2.13155C21.0692 2.1265 21.0709 2.12319 21.0719 2.12125L21.0732 2.11882L21.0757 2.11744C21.0776 2.11643 21.0809 2.11482 21.086 2.11274C21.1078 2.10378 21.1561 2.08849 21.2527 2.07551C21.4634 2.04718 21.7574 2.04558 22.25 2.04558L23.75 2.04558C24.2426 2.04558 24.5366 2.04718 24.7473 2.07551C24.8439 2.08849 24.8923 2.10378 24.914 2.11274C24.9191 2.11482 24.9224 2.11643 24.9243 2.11744L24.9268 2.11882L24.9281 2.12125C24.9292 2.12319 24.9308 2.1265 24.9328 2.13155C24.9418 2.15333 24.9571 2.20169 24.9701 2.29825C24.9984 2.50897 25 2.80298 25 3.29558L25 15.7041C25 16.1967 24.9984 16.4907 24.9701 16.7014C24.9571 16.798 24.9418 16.8463 24.9328 16.8681C24.9308 16.8732 24.9292 16.8765 24.9281 16.8784L24.9268 16.8809L24.9243 16.8822C24.9224 16.8832 24.9191 16.8849 24.914 16.8869C24.8923 16.8959 24.8439 16.9112 24.7473 16.9242C24.5366 16.9525 24.2426 16.9541 23.75 16.9541L22.25 16.9541C21.7574 16.9541 21.4634 16.9525 21.2527 16.9242C21.1561 16.9112 21.1078 16.8959 21.086 16.8869C21.0809 16.8849 21.0776 16.8832 21.0757 16.8822L21.0732 16.8809ZM24.9268 16.8809C24.9264 16.8811 24.9264 16.8813 24.9268 16.8809C24.9272 16.8804 24.9271 16.8805 24.9268 16.8809ZM24.9268 2.11882C24.9268 2.11883 24.9268 2.11883 24.9268 2.11882Z"></path>
        </svg>
      </button>
      <button type="button" class="change-button-mobile" data-index="1">
        <svg width="18" height="17" viewBox="0 0 18 17" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M2.70526 0.250003C2.72013 0.250005 2.73505 0.250007 2.75001 0.250007L15.2033 0.250003C15.6361 0.249952 16.0329 0.249906 16.3557 0.293307C16.7112 0.3411 17.0869 0.453547 17.396 0.76257C17.705 1.07159 17.8174 1.44732 17.8652 1.8028C17.9086 2.12561 17.9086 2.52244 17.9085 2.95526V4.54475C17.9086 4.97757 17.9086 5.3744 17.8652 5.69721C17.8174 6.05269 17.705 6.42842 17.396 6.73744C17.0869 7.04647 16.7112 7.15891 16.3557 7.20671C16.0329 7.25011 15.6361 7.25006 15.2033 7.25001L2.75001 7.25001C2.73505 7.25001 2.72014 7.25001 2.70526 7.25001C2.27244 7.25006 1.87561 7.25011 1.5528 7.20671C1.19732 7.15891 0.821593 7.04647 0.51257 6.73744C0.203547 6.42842 0.0910996 6.05269 0.0433066 5.69721C-9.43281e-05 5.3744 -4.75394e-05 4.97757 3.48216e-06 4.54476C5.21069e-06 4.52988 6.99883e-06 4.51496 6.99883e-06 4.50001V3.00001C6.99883e-06 2.98505 5.21069e-06 2.97013 3.48216e-06 2.95526C-4.75394e-05 2.52244 -9.43281e-05 2.12561 0.0433066 1.8028C0.0910996 1.44732 0.203547 1.07159 0.51257 0.76257C0.821593 0.453547 1.19732 0.3411 1.5528 0.293307C1.87561 0.249906 2.27244 0.249952 2.70526 0.250003ZM1.57324 1.82324L1.57568 1.82187C1.57761 1.82086 1.58093 1.81924 1.58597 1.81717C1.60775 1.80821 1.65611 1.79291 1.75267 1.77993C1.96339 1.7516 2.2574 1.75001 2.75001 1.75001H15.1585C15.6511 1.75001 15.9451 1.7516 16.1559 1.77993C16.2524 1.79291 16.3008 1.80821 16.3226 1.81717C16.3276 1.81924 16.3309 1.82086 16.3328 1.82187L16.3353 1.82324L16.3367 1.82568C16.3377 1.82761 16.3393 1.83093 16.3414 1.83597C16.3503 1.85775 16.3656 1.90611 16.3786 2.00267C16.4069 2.21339 16.4085 2.5074 16.4085 3.00001V4.50001C16.4085 4.99261 16.4069 5.28662 16.3786 5.49734C16.3656 5.5939 16.3503 5.64226 16.3414 5.66404C16.3393 5.66909 16.3377 5.6724 16.3367 5.67434L16.3353 5.67677L16.3328 5.67815C16.3309 5.67916 16.3276 5.68077 16.3226 5.68285C16.3008 5.69181 16.2524 5.7071 16.1559 5.72008C15.9451 5.74841 15.6511 5.75001 15.1585 5.75001H2.75001C2.2574 5.75001 1.96339 5.74841 1.75267 5.72008C1.65611 5.7071 1.60775 5.69181 1.58597 5.68285C1.58093 5.68077 1.57761 5.67916 1.57568 5.67815L1.57324 5.67677L1.57187 5.67434C1.57086 5.6724 1.56924 5.66909 1.56717 5.66404C1.55821 5.64226 1.54291 5.5939 1.52993 5.49734C1.5016 5.28662 1.50001 4.99261 1.50001 4.50001V3.00001C1.50001 2.5074 1.5016 2.21339 1.52993 2.00267C1.54291 1.90611 1.55821 1.85775 1.56717 1.83597C1.56924 1.83093 1.57086 1.82761 1.57187 1.82568L1.57324 1.82324ZM1.57324 5.67677C1.57297 5.67644 1.57284 5.67636 1.57324 5.67677C1.5737 5.67723 1.57359 5.67705 1.57324 5.67677ZM16.3353 5.67677C16.3353 5.67679 16.3353 5.67679 16.3353 5.67677Z"></path>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M2.70526 9.75C2.72013 9.75001 2.73505 9.75001 2.75001 9.75001L15.2033 9.75C15.6361 9.74995 16.0329 9.74991 16.3557 9.79331C16.7112 9.8411 17.0869 9.95355 17.396 10.2626C17.705 10.5716 17.8174 10.9473 17.8652 11.3028C17.9086 11.6256 17.9086 12.0224 17.9085 12.4553V14.0448C17.9086 14.4776 17.9086 14.8744 17.8652 15.1972C17.8174 15.5527 17.705 15.9284 17.396 16.2374C17.0869 16.5465 16.7112 16.6589 16.3557 16.7067C16.0329 16.7501 15.6361 16.7501 15.2033 16.75L2.75001 16.75C2.73505 16.75 2.72014 16.75 2.70526 16.75C2.27244 16.7501 1.87561 16.7501 1.5528 16.7067C1.19732 16.6589 0.821593 16.5465 0.51257 16.2374C0.203547 15.9284 0.0910996 15.5527 0.0433066 15.1972C-9.43281e-05 14.8744 -4.75394e-05 14.4776 3.48216e-06 14.0448C5.21069e-06 14.0299 6.99883e-06 14.015 6.99883e-06 14V12.5C6.99883e-06 12.485 5.21069e-06 12.4701 3.48216e-06 12.4553C-4.75394e-05 12.0224 -9.43281e-05 11.6256 0.0433066 11.3028C0.0910996 10.9473 0.203547 10.5716 0.51257 10.2626C0.821593 9.95355 1.19732 9.8411 1.5528 9.79331C1.87561 9.74991 2.27244 9.74995 2.70526 9.75ZM1.57324 11.3232L1.57568 11.3219C1.57761 11.3209 1.58093 11.3192 1.58597 11.3172C1.60775 11.3082 1.65611 11.2929 1.75267 11.2799C1.96339 11.2516 2.2574 11.25 2.75001 11.25H15.1585C15.6511 11.25 15.9451 11.2516 16.1559 11.2799C16.2524 11.2929 16.3008 11.3082 16.3226 11.3172C16.3276 11.3192 16.3309 11.3209 16.3328 11.3219L16.3353 11.3232L16.3367 11.3257C16.3377 11.3276 16.3393 11.3309 16.3414 11.336C16.3503 11.3578 16.3656 11.4061 16.3786 11.5027C16.4069 11.7134 16.4085 12.0074 16.4085 12.5V14C16.4085 14.4926 16.4069 14.7866 16.3786 14.9973C16.3656 15.0939 16.3503 15.1423 16.3414 15.164C16.3393 15.1691 16.3377 15.1724 16.3367 15.1743L16.3353 15.1768L16.3328 15.1781C16.3309 15.1792 16.3276 15.1808 16.3226 15.1828C16.3008 15.1918 16.2524 15.2071 16.1559 15.2201C15.9451 15.2484 15.6511 15.25 15.1585 15.25H2.75001C2.2574 15.25 1.96339 15.2484 1.75267 15.2201C1.65611 15.2071 1.60775 15.1918 1.58597 15.1828C1.58093 15.1808 1.57761 15.1792 1.57568 15.1781L1.57324 15.1768L1.57187 15.1743C1.57086 15.1724 1.56924 15.1691 1.56717 15.164C1.55821 15.1423 1.54291 15.0939 1.52993 14.9973C1.5016 14.7866 1.50001 14.4926 1.50001 14V12.5C1.50001 12.0074 1.5016 11.7134 1.52993 11.5027C1.54291 11.4061 1.55821 11.3578 1.56717 11.336C1.56924 11.3309 1.57086 11.3276 1.57187 11.3257L1.57324 11.3232ZM1.57324 15.1768C1.57297 15.1764 1.57284 15.1764 1.57324 15.1768C1.5737 15.1772 1.57359 15.1771 1.57324 15.1768ZM16.3353 15.1768C16.3353 15.1768 16.3353 15.1768 16.3353 15.1768Z"></path>
        </svg>
      </button>
    </div>
    <details class="mobile-facets__disclosure disclosure-has-popup">
      <summary class="mobile-facets__open-wrapper focus-offset">
        <span class="mobile-facets__open{% if filter_type == 'drawer' and enable_filtering == false %} medium-hide large-up-hide{% endif %}">
          {% render 'icon-filter' %}
          <span class="mobile-facets__open-label button-label medium-hide large-up-hide">
            {%- if enable_filtering and enable_sorting -%}
              {{ 'products.facets.filter_and_sort' | t }}
            {%- elsif enable_filtering -%}
              {{ 'products.facets.filter_button' | t }}
            {%- elsif enable_sorting -%}
              {{ 'products.facets.sort_button' | t }}
            {%- endif -%}
          </span>
          <span class="mobile-facets__open-label button-label small-hide">
            {%- if enable_filtering -%}
              {{ 'products.facets.filter_button' | t }}
            {%- endif -%}
          </span>
        </span>
        <span tabindex="0" class="mobile-facets__close mobile-facets__close--no-js">{%- render 'icon-close' -%}</span>
      </summary>
      <facet-filters-form>
        <form id="FacetFiltersFormMobile" class="mobile-facets">
          <div class="mobile-facets__inner gradient">
            <div class="mobile-facets__header">
              <div class="mobile-facets__header-inner">
                <h2 class="mobile-facets__heading medium-hide large-up-hide">
                  {%- if enable_filtering and enable_sorting -%}
                    {{ 'products.facets.filter_and_sort' | t }}
                  {%- elsif enable_filtering -%}
                    {{ 'products.facets.filter_button' | t }}
                  {%- elsif enable_sorting -%}
                    {{ 'products.facets.sort_button' | t }}
                  {%- endif -%}
                </h2>
                <h2 class="mobile-facets__heading small-hide">
                  {%- if enable_filtering -%}
                    {{ 'products.facets.filter_button' | t }}
                  {%- endif -%}
                </h2>
                <p class="mobile-facets__count">
                  {%- if results.results_count -%}
                    {{ 'templates.search.results_with_count' | t: terms: results.terms, count: results.results_count }}
                  {%- elsif results.products_count == results.all_products_count -%}
                    {{ 'products.facets.product_count_simple' | t: count: results.products_count }}
                  {%- else -%}
                    {{
                      'products.facets.product_count'
                      | t: product_count: results.products_count, count: results.all_products_count
                    }}
                  {%- endif -%}
                </p>
              </div>
            </div>
            <ul class="facets-menu__link-container-mobile{% unless filter_type == 'vertical' %} medium-hide large-up-hide{% endunless %}">
              {% for childLink in section.settings.menu.links %}
                {% if childLink.links != blank %}
                  <li>
                  <details class="facets__disclosure-vertical">
                    <summary
                        class="facets__summary caption-large focus-offset facets-menu__link-summary"
                      >
                        <div>
                          <span class="facets__summary-label">
                            {{- childLink.title | escape }}
                          </span>
                          {% render 'icon-caret' %}
                        </div>
                      </summary>
                    <ul>
                      {% for grandChild in childLink.links %}
                        <li class="caption-large link link-text focus-inset facets-menu__link-summary">{{ grandChild.title | link_to: grandChild.url }}</li>
                      {% endfor %}
                    </ul>
                  </details>
                  </li>
                  {% else %}
                  <li class="facets-menu__link-summary facets__summary">{{ childLink.title | link_to: childLink.url }}</li>
                {% endif %}
              {% endfor %}
            </ul>
            <div class="mobile-facets__main has-submenu gradient">
              {%- if enable_filtering -%}
                {%- for filter in results.filters -%}
                  {% liquid
                    case filter.presentation
                      when 'swatch'
                        assign has_visual_display = true
                        assign visual_layout_class = 'facets-layout-grid facets-layout-grid--' | append: filter.presentation
                      else
                        assign has_visual_display = false
                        assign visual_layout_class = 'facets-layout-list'
                    endcase
                  %}

                  {% case filter.type %}
                    {% when 'boolean', 'list' %}
                      <details
                        id="Details-Mobile-{{ forloop.index }}-{{ section.id }}"
                        class="mobile-facets__details js-filter"
                        data-index="mobile-{{ forloop.index }}"
                      >
                        <summary class="mobile-facets__summary focus-inset">
                          <div>
                            <span>{{ filter.label | escape }}</span>
                            <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                            <noscript>{% render 'icon-caret' %}</noscript>
                          </div>
                        </summary>
                        <div
                          id="FacetMobile-{{ forloop.index }}-{{ section.id }}"
                          class="mobile-facets__submenu gradient"
                        >
                          <button
                            class="mobile-facets__close-button link link--text focus-inset"
                            aria-expanded="true"
                            type="button"
                          >
                            {% render 'icon-arrow' %}
                            <span>{{ filter.label | escape }}</span>
                            {%- if filter.operator == 'AND' -%}
                              <span class="facets__and-helptext">
                                {{ 'products.facets.filter_and_operator_subtitle' | t }}
                              </span>
                            {%- endif -%}
                          </button>
                          <ul class="{{ visual_layout_class }} mobile-facets__list list-unstyled" role="list">
                            {%- liquid
                              assign sorted_values = filter.values
                              # Keep the selected values grouped together when operator is AND
                              if filter.operator == 'AND'
                                assign active_filter_values = filter.values | where: 'active', true
                                assign inactive_filter_values = filter.values | where: 'active', false
                                assign sorted_values = active_filter_values | concat: inactive_filter_values
                              endif
                            -%}
                            {%- for value in sorted_values -%}
                              {% liquid
                                assign is_disabled = false
                                if value.count == 0 and value.active == false
                                  assign is_disabled = true
                                endif
                              %}

                              <li class="mobile-facets__item list-menu__item">
                                <label
                                  for="Filter-{{ filter.param_name | escape }}-mobile-{{ forloop.index }}"
                                  class="facets__label item-swatch mobile-facets__label{% if is_disabled %} mobile-facets__label--disabled disabled{% endif %}{% if has_visual_display %} visual-display-parent visual-display-parent--{{ filter.presentation }}{% endif %}{% if value.active %} active{% endif %}"
                                >
                                  <input
                                    class="mobile-facets__checkbox"
                                    type="checkbox"
                                    name="{{ value.param_name }}"
                                    value="{{ value.value }}"
                                    id="Filter-{{ filter.param_name | escape }}-mobile-{{ forloop.index }}"
                                    {% if value.active %}
                                      checked
                                    {% endif %}
                                    {% if is_disabled %}
                                      disabled
                                    {% endif %}
                                  >

                                  {% if has_visual_display %}
                                    <div class="facets__visual-display-wrapper">
                                      {% render 'visual-display',
                                        type: value.display.type,
                                        value: value.display.value,
                                        presentation: filter.presentation
                                      %}
                                    </div>
                                  {% else %}
                                    <span class="mobile-facets__highlight"></span>

                                    <svg
                                      width="1.6rem"
                                      height="1.6rem"
                                      viewBox="0 0 16 16"
                                      aria-hidden="true"
                                      focusable="false"
                                      data-value="{{ value.value }}"
                                    >
                                      <rect width="16" height="16"  fill="none" ></rect>
                                    </svg>
                                  {% endif %}

                                  <span class="facet-checkbox__text" aria-hidden="true">
                                    {{- value.label | escape }} ({{ value.count }})</span
                                  >
                                  <span class="visually-hidden">
                                    {{- value.label | escape }} (
                                    {%- if value.count == '1' -%}
                                      {{- 'products.facets.product_count_simple.one' | t: count: value.count -}}
                                    {%- else -%}
                                      {{- 'products.facets.product_count_simple.other' | t: count: value.count -}}
                                    {%- endif -%}
                                    )</span
                                  >
                                </label>
                              </li>
                            {%- endfor -%}
                          </ul>

                          <div class="no-js-hidden mobile-facets__footer gradient">
                            <facet-remove class="mobile-facets__clear-wrapper">
                              <a href="{{ filter.url_to_remove }}" class="mobile-facets__clear underlined-link">
                                {{- 'products.facets.clear' | t -}}
                              </a>
                            </facet-remove>
                            <button
                              type="button"
                              class="no-js-hidden button button--primary"
                              onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()"
                            >
                              {{ 'products.facets.apply' | t }}
                            </button>
                            <noscript
                              ><button class="button button--primary">
                                {{ 'products.facets.apply' | t }}
                              </button></noscript
                            >
                          </div>
                        </div>
                      </details>
                    {% when 'price_range' %}
                      {% liquid
                        assign currencies_using_comma_decimals = 'ANG,ARS,BRL,BYN,BYR,CLF,CLP,COP,CRC,CZK,DKK,EUR,HRK,HUF,IDR,ISK,MZN,NOK,PLN,RON,RUB,SEK,UYU,VES,VND' | split: ','
                        assign uses_comma_decimals = false
                        if currencies_using_comma_decimals contains cart.currency.iso_code
                          assign uses_comma_decimals = true
                        endif
                      %}
                      <details
                        id="Details-Mobile-{{ forloop.index }}-{{ section.id }}"
                        class="mobile-facets__details js-filter"
                        data-index="mobile-{{ forloop.index }}"
                      >
                        <summary class="mobile-facets__summary focus-inset">
                          <div>
                            <span>{{ filter.label | escape }}</span>
                            <span class="mobile-facets__arrow no-js-hidden">{% render 'icon-arrow' %}</span>
                            <noscript>{% render 'icon-caret' %}</noscript>
                          </div>
                        </summary>
                        <div
                          id="FacetMobile-{{ forloop.index }}-{{ section.id }}"
                          class="mobile-facets__submenu gradient"
                        >
                          <button
                            class="mobile-facets__close-button link link--text focus-inset"
                            aria-expanded="true"
                            type="button"
                          >
                            {% render 'icon-arrow' %}
                            {{ filter.label | escape }}
                          </button>

                          {%- assign max_price_amount = filter.range_max | money | strip_html | escape -%}
                          <p class="mobile-facets__info">
                            {{ 'products.facets.max_price' | t: price: max_price_amount }}
                          </p>

                          <price-range class="facets__price">
                            <span class="field-currency">{{ cart.currency.symbol }}</span>
                            <div class="field">
                              <input
                                class="field__input"
                                name="{{ filter.min_value.param_name }}"
                                id="Mobile-Filter-{{ filter.label | escape }}-GTE"
                                {%- if filter.min_value.value -%}
                                  {%- if uses_comma_decimals -%}
                                    value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                  {%- else -%}
                                    value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                                  {%- endif %}
                                {%- endif -%}
                                type="number"
                                placeholder="0"
                                min="0"
                                inputmode="decimal"
                                {%- if uses_comma_decimals -%}
                                  max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                {%- else -%}
                                  max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                                {% endif %}
                              >
                              <label class="field__label" for="Mobile-Filter-{{ filter.label | escape }}-GTE">
                                {{- 'products.facets.from' | t -}}
                              </label>
                            </div>

                            <span class="field-currency">{{ cart.currency.symbol }}</span>
                            <div class="field">
                              <input
                                class="field__input"
                                name="{{ filter.max_value.param_name }}"
                                id="Mobile-Filter-{{ filter.label | escape }}-LTE"
                                {%- if filter.max_value.value -%}
                                  {%- if uses_comma_decimals -%}
                                    value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                  {%- else -%}
                                    value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                                  {%- endif %}
                                {%- endif -%}
                                type="number"
                                min="0"
                                inputmode="decimal"
                                {%- if uses_comma_decimals -%}
                                  placeholder="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                  max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '.' }}"
                                {%- else -%}
                                  placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                                  max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                                {% endif %}
                              >
                              <label class="field__label" for="Mobile-Filter-{{ filter.label | escape }}-LTE">
                                {{- 'products.facets.to' | t -}}
                              </label>
                            </div>
                          </price-range>
                          <div class="no-js-hidden mobile-facets__footer">
                            <facet-remove class="mobile-facets__clear-wrapper">
                              <a href="{{ filter.url_to_remove }}" class="mobile-facets__clear underlined-link">
                                {{- 'products.facets.clear' | t -}}
                              </a>
                            </facet-remove>
                            <button
                              type="button"
                              class="no-js-hidden button button--primary"
                              onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()"
                            >
                              {{ 'products.facets.apply' | t }}
                            </button>
                            <noscript
                              ><button class="button button--primary">
                                {{ 'products.facets.apply' | t }}
                              </button></noscript
                            >
                          </div>
                        </div>
                      </details>
                  {% endcase %}
                {%- endfor -%}
              {%- endif -%}

              {%- if enable_sorting -%}
                <div
                  class="mobile-facets__details js-filter{% if filter_type == 'drawer' %} medium-hide large-up-hide{% endif %}"
                  data-index="mobile-{{ forloop.index }}"
                >
                  <div class="mobile-facets__summary">
                    <div class="mobile-facets__sort">
                      <label for="SortBy-mobile">{{ 'products.facets.sort_by_label' | t }}</label>
                      <div class="select">
                        <select
                          name="sort_by"
                          class="select__select"
                          id="SortBy-mobile"
                          aria-describedby="a11y-refresh-page-message"
                        >
                          {%- for option in results.sort_options -%}
                            <option
                              value="{{ option.value | escape }}"
                              {% if option.value == sort_by %}
                                selected="selected"
                              {% endif %}
                            >
                              {{ option.name | escape }}
                            </option>
                          {%- endfor -%}
                        </select>
                        {% render 'icon-caret' %}
                      </div>
                    </div>
                  </div>
                </div>
              {%- endif -%}

              <div class="mobile-facets__footer">
                <facet-remove class="mobile-facets__clear-wrapper">
                  <a href="{{ results_url }}" class="mobile-facets__clear underlined-link">
                    {{- 'products.facets.clear_all' | t -}}
                  </a>
                </facet-remove>
                <button
                  type="button"
                  class="no-js-hidden button button--primary"
                  onclick="this.closest('.mobile-facets__wrapper').querySelector('summary').click()"
                >
                  {{ 'products.facets.apply' | t }}
                </button>
                <noscript
                  ><button class="button button--primary">{{ 'products.facets.apply' | t }}</button></noscript
                >
              </div>
            </div>

            {% if results.current_vendor or results.current_type %}
              <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
            {% endif %}

            {%- if results.terms -%}
              <input type="hidden" name="q" value="{{ results.terms | escape }}">
              <input name="options[prefix]" type="hidden" value="last">
            {%- endif -%}
          </div>
        </form>
      </facet-filters-form>
    </details>
  </menu-drawer>

  <div class="active-facets active-facets-mobile medium-hide large-up-hide">
    {%- for filter in results.filters -%}
      {%- for value in filter.active_values -%}
        <facet-remove>
          <a href="{{ value.url_to_remove }}" class="active-facets__button active-facets__button--light">
            <span class="active-facets__button-inner button button--tertiary">
              {{ filter.label }}: {{ value.label | escape }}
              {% render 'icon-close-small' %}
              <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
            </span>
          </a>
        </facet-remove>
      {%- endfor -%}

      {%- if filter.type == 'price_range' -%}
        {%- if filter.min_value.value != null or filter.max_value.value != null -%}
          <facet-remove>
            <a href="{{ filter.url_to_remove }}" class="active-facets__button active-facets__button--light">
              <span class="active-facets__button-inner button button--tertiary">
                {%- if filter.min_value.value -%}
                  {{ filter.min_value.value | money }}
                {%- else -%}
                  {{ 0 | money }}
                {%- endif -%}
                -
                {%- if filter.max_value.value -%}
                  {{ filter.max_value.value | money }}
                {%- else -%}
                  {{ filter.range_max | money }}
                {%- endif -%}
                {% render 'icon-close-small' %}
                <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
              </span>
            </a>
          </facet-remove>
        {%- endif -%}
      {%- endif -%}
    {%- endfor -%}
    <facet-remove class="active-facets__button-wrapper">
      <a href="{{ results_url }}" class="active-facets__button-remove underlined-link">
        <span>{{ 'products.facets.clear_all' | t }}</span>
      </a>
    </facet-remove>
  </div>
  {% comment %} Sort, product count and filter pills at the end when filter is type of Drawer for the correct tabbing order {% endcomment %}
  {%- if enable_sorting and filter_type == 'drawer' -%}
    <facet-filters-form class="facets small-hide">
      <form id="FacetSortDrawerForm" class="facets__form">
        <div class="facet-filters sorting caption small-hide">
          <div class="facet-filters__field">
            <h2 class="facet-filters__label caption-large text-body">
              <label for="SortBy">{{ 'products.facets.sort_by_label' | t }}</label>
            </h2>
            <div class="select">
              {%- assign sort_by = results.sort_by | default: results.default_sort_by -%}
              <select
                name="sort_by"
                class="facet-filters__sort select__select caption-large"
                id="SortBy"
                aria-describedby="a11y-refresh-page-message"
              >
                {%- for option in results.sort_options -%}
                  <option
                    value="{{ option.value | escape }}"
                    {% if option.value == sort_by %}
                      selected="selected"
                    {% endif %}
                  >
                    {{ option.name | escape }}
                  </option>
                {%- endfor -%}
              </select>
              {% render 'icon-caret' %}
            </div>
          </div>

          <noscript>
            <button type="submit" class="facets__button-no-js button button--secondary">
              {{ 'products.facets.sort_button' | t }}
            </button>
          </noscript>
        </div>

        {% if results.current_vendor or results.current_type %}
          <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
        {% endif %}

        {%- if results.terms -%}
          <input type="hidden" name="q" value="{{ results.terms | escape }}">
          <input name="options[prefix]" type="hidden" value="last">
        {%- endif -%}
      </form>
    </facet-filters-form>
  {%- endif -%}
  
  {%- if filter_type == 'drawer' -%}
    <facet-filters-form class="facets facets-pill small-hide">
      <form id="FacetFiltersPillsForm" class="facets__form">
        <div class="active-facets active-facets-desktop">
          {%- for filter in results.filters -%}
            {%- for value in filter.active_values -%}
              <facet-remove>
                <a href="{{ value.url_to_remove }}" class="active-facets__button active-facets__button--light">
                  <span class="active-facets__button-inner button button--tertiary">
                    {{ filter.label }}: {{ value.label | escape }}
                    {% render 'icon-close-small' %}
                    <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                  </span>
                </a>
              </facet-remove>
            {%- endfor -%}

            {%- if filter.type == 'price_range' -%}
              {%- if filter.min_value.value != null or filter.max_value.value != null -%}
                <facet-remove>
                  <a href="{{ filter.url_to_remove }}" class="active-facets__button active-facets__button--light">
                    <span class="active-facets__button-inner button button--tertiary">
                      {%- if filter.min_value.value -%}
                        {{ filter.min_value.value | money }}
                      {%- else -%}
                        {{ 0 | money }}
                      {%- endif -%}
                      -
                      {%- if filter.max_value.value -%}
                        {{ filter.max_value.value | money }}
                      {%- else -%}
                        {{ filter.range_max | money }}
                      {%- endif -%}
                      {% render 'icon-close-small' %}
                      <span class="visually-hidden">{{ 'products.facets.clear_filter' | t }}</span>
                    </span>
                  </a>
                </facet-remove>
              {%- endif -%}
            {%- endif -%}
          {%- endfor -%}
          <facet-remove class="active-facets__button-wrapper">
            <a href="{{ results_url }}" class="active-facets__button-remove underlined-link">
              <span>{{ 'products.facets.clear_all' | t }}</span>
            </a>
          </facet-remove>
        </div>
      </form>
    </facet-filters-form>
  {%- endif -%}
</div>
